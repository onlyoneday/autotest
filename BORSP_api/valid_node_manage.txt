| *** Settings *** |
| Suite Setup    | Get Token |
| Suite Teardown | Delete All Sessions |
| Library        | Collections |
| Library        | String |
| Library        | OperatingSystem |
| Library        | RequestsLibrary |
| Library        | Collections |
| Library        | XML |
| Library        | json |
| Library        | SSHLibrary |
| Resource       | config.txt |

| *** Test Cases *** |
| 主机管理-获取集群主机列表 |
|    | [Tags] | 主机管理 |
|    | Create Session | shurenyun | ${SERVER} |
|    | ${resp}= | Get Request | shurenyun | /v1/nodes | headers=${headers} |
|    | Should Be Equal As Strings | ${resp.status_code} | 200 |
|    | ${nodeip}= | Evaluate | '${resp.json()['data']['masters'][0]['ip']}' |
|    | Set Global Variable | ${nodeip} |

| 主机管理-获取集群监控信息 |
|    | [Tags] | 主机管理 |
|    | Create Session | shurenyun | ${SERVER} |
|    | ${resp}= | Get Request | shurenyun | /v1/metrics/snapshot | headers=${headers} |
|    | Should Be Equal As Strings | ${resp.status_code} | 200 |

| 主机管理-获取指定主机的信息 |
|    | [Tags] | 主机管理 |
|    | Create Session | shurenyun | ${SERVER} |
|    | ${path}= | Evaluate | '/v1/nodes/'+'${nodeip}'+'/info' |
|    | ${resp}= | Get Request | shurenyun | ${path} | headers=${headers} |
|    | Should Be Equal As Strings | ${resp.status_code} | 200 |
|    | log | ${resp.text} |

| 主机管理-获取指定主机的容器列表 |
|    | [Tags] | 主机管理 |
|    | Create Session | shurenyun | ${SERVER} |
|    | ${path}= | Evaluate | '/v1/nodes/'+'${nodeip}'+'/instances' |
|    | ${resp}= | Get Request | shurenyun | ${path} | headers=${headers} |
|    | Should Be Equal As Strings | ${resp.status_code} | 200 |
|    | log | ${resp.text} |

| 主机管理-获取指定主机的镜像列表 |
|    | [Tags] | 主机管理 |
|    | Create Session | shurenyun | ${SERVER} |
|    | ${path}= | Evaluate | '/v1/nodes/'+'${nodeip}'+'/images' |
|    | ${resp}= | Get Request | shurenyun | ${path} | headers=${headers} |
|    | Should Be Equal As Strings | ${resp.status_code} | 200 |
|    | log | ${resp.text} |

| 主机管理-删除指定主机上的指定镜像 |
|    | [Tags] | 主机管理 |
|    | Open Connection | ${HOST} |
|    | Login | ${USERNAME} | ${PASSWORD} |
|    | ${output}= | Execute Command | docker pull alpine:3.1 |
|    | log to console | ${\n}${output} |
